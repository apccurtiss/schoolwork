<html>
<head>
<title>Final Project - Alexander Curtiss</title>
<meta charset="utf-8">
<!--
  CanvasMatrix class
  (c) Apple Inc
  -->
<script src="CanvasMatrix.js" type="text/javascript"></script>
<script src="sphere.js" type="text/javascript"></script>
<script src="shaders.js" type="text/javascript"></script>
<script src="main.js" type="text/javascript"></script>

<!--
  Vertex shader
  Modified from ex08
  -->
<script id="shader-vs" type="x-shader/x-vertex"> 
   precision highp float;
   attribute vec3 XYZ;
   attribute vec3 RGB;
   attribute vec3 NORM;
   attribute vec2 TEX;
   uniform mat4 ProjectionMatrix;
   uniform mat4 ModelviewMatrix;
   uniform mat4 NormalMatrix;
   varying vec3 col;
   varying vec2 fTEX;
   varying vec3 P;
   varying vec3 N;
   void main(void)
   {
      //  Passed to frag shader for Phong lighting
      P = vec3(ModelviewMatrix * vec4(XYZ,1.0));
      N = normalize(vec3(NormalMatrix) * NORM);
      
      //  Textures
      fTEX = TEX;
      
      //  Colors
      col = RGB;
      
      //  Translate
      gl_Position = ProjectionMatrix * ModelviewMatrix * vec4(XYZ,1);
      
   }
</script> 
 
<!--
  Fragment shader
  -->
<script id="shader-fs" type="x-shader/x-fragment"> 
precision highp float;
varying vec3 col;
varying highp vec2 fTEX;
uniform sampler2D uSampler;

uniform vec4 LightPos;
uniform vec4 ambient;
uniform vec4 diffuse;
uniform vec4 specular;
uniform float shininess;

uniform mat4 ModelviewMatrix;
varying vec3 P;
varying vec3 N;
void main(void)
{
   //  Per-pixel Phong lighting
   vec3 L = vec3(normalize(ModelviewMatrix * LightPos));
   vec3 R = reflect(-L, N);
   vec3 V = normalize(-P);
   float Id = max(dot(L,N), 0.0);
   float Is = (Id > 0.0) ? pow(max(dot(V,R), 0.0), shininess) : 0.0;
   
   //  Add textures and color
   gl_FragColor = texture2D(uSampler, vec2(fTEX.s, fTEX.t)) * vec4(col,1) * (ambient + diffuse*Id + specular*Is);
}
</script> 

<!--
  Web page
  -->
</head>
<body onload="render();" onresize="canvas.resize();">
   <canvas id="canvas" width="500" height="500"></canvas> 
</body>
</html>
